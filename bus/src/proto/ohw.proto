syntax = "proto3";

package ohw;

message ReqData
{
	oneof payload
	{
		Unknown unknown = 2;
		VersionRequest version_request = 10;
		InitWalletCustomRequest init_custom_request = 30;
		InitWalletRequest init_request = 40;
		DerivePublicKeyRequest derive_public_key_request = 50;
		SignEthRequest sign_eth_request = 70;
	}
}

message ResData
{
	oneof payload
	{
		ErrorResponse error_response = 1;
		Unknown unknown = 2;
		VersionResponse version_response = 11;
		InitWalletResponse init_wallet_response = 31;
		DerivePublicKeyResponse derive_public_key_response = 51;
		SignResponse sign_response = 61;
		WaitForUserActionResponse wait_for_user_action_response = 80;
	}
}

message Unknown
{
}

message VersionRequest
{
}

message VersionResponse
{
	string version = 1;
	Features features = 2;
}

message Features
{
	bool initialized = 10;
	bytes support_mask = 20;
}

message InitWalletCustomRequest
{
	string words = 2;
	string password = 3;
}

message InitWalletRequest
{
	uint32 length = 1;
	string password = 2;
	optional bytes seed = 3;
}

message InitWalletResponse
{
	optional string mnemonic = 1;
}

message DerivePublicKeyRequest
{
	string path = 1;
}

message DerivePublicKeyResponse
{
	string path = 1;
	bytes public_key = 2;
}

message SignEthRequest
{
	int32 id = 1;
	string path = 2;
	oneof tx
	{
		AppEthTxEip2930 eip2930 = 10;
		AppEthTxEip191 eip191 = 20;
	}
	optional string debug_text = 5;
}

message AppEthTxEip191
{
	string message = 1;
	optional bool is_personal = 2;
}

message AppEthTxEip2930
{
	uint64 chain_id = 1;
	uint64 nonce = 2;
	optional string to = 5;
	string gas_price = 3;
	uint64 gas_limit = 4;
	string value = 6;
	optional bytes input = 7;
	optional bytes access_list = 8;
}

message SignResponse
{
	int32 id = 1;
	bytes message = 2;
	bytes public_key = 3;
	bytes pre_hash = 4;
	bytes signature = 5;
	optional uint32 recovery_id = 6;
}

message ErrorResponse
{
	int32 code = 1;
	string message = 2;
}

message WaitForUserActionResponse
{
}